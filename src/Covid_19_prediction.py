# -*- coding: utf-8 -*-
"""Covid 19 Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1v-vuiFUJ_7MZgBlZgpzUnigGiwWP0_gc
"""

import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
import warnings
warnings.filterwarnings('ignore')

df=pd.read_csv('/content/Covid_19.csv')
df

df.shape

df.info()

df.rename(columns={
    "Province/State":"State",
    "Country/Region":"Country"},inplace=True)
df

df['Date'].value_counts()

df['Date'].max()

top_date=df[df['Date']=='2020-07-27']

top_date.head(10)

top_date.groupby(['Country'])[['Confirmed','Deaths','Recovered','Active']].sum().reset_index()

confirmed_cases=df.groupby(['Date'])['Confirmed'].sum().reset_index()
confirmed_cases

plt.figure(figsize=(20,5))
sns.lineplot(data=confirmed_cases,x='Date',y='Confirmed')
plt.xlabel('Dates')
plt.ylabel('Confirmed')
plt.show()

death_cases = df.groupby(['Date'])['Deaths'].sum().reset_index()
death_cases

plt.figure(figsize=(20,5))
sns.lineplot(data=death_cases,x='Date',y='Deaths')
plt.xlabel('Dates')
plt.ylabel('Deaths')
plt.show()

recovered_cases = df.groupby(['Date'])['Recovered'].sum().reset_index()
recovered_cases

plt.figure(figsize=(20,5))
sns.lineplot(data=recovered_cases,x='Date',y='Recovered')
plt.xlabel('Dates')
plt.ylabel('Recovered')
plt.show()

active_cases=df.groupby(['Date'])['Active'].sum().reset_index()
active_cases

plt.figure(figsize=(20,5))
sns.lineplot(data=active_cases,x='Date',y='Active')
plt.xlabel('Dates')
plt.ylabel('Active')
plt.show()

plt.figure(figsize=(20,5))
sns.pointplot(data=confirmed_cases,x='Date',y='Confirmed',color='Red')
sns.pointplot(data=death_cases,x='Date',y='Deaths',color='Blue')
sns.pointplot(data=active_cases,x='Date',y='Active',color='Yellow')
sns.pointplot(data=recovered_cases,x='Date',y='Recovered',color='Green')
# plt.xlabel('Dates')
# plt.ylabel('Recovered')
plt.show()

# Pick and Top 3 effected countries
# 1.us
# 2.china
# 3.india

US=df[df['Country']=='US']
US

US=US.groupby(['Date'])[['Confirmed','Deaths','Recovered','Active']].sum().reset_index()
US

China = df[df['Country']=='China']
China.head()

China=China.groupby(['Date'])[['Confirmed','Deaths','Recovered','Active']].sum().reset_index()
China

India = df[df['Country'] == 'India']
India = India.groupby(['Date'])[['Confirmed', 'Deaths', 'Recovered', 'Active']].sum().reset_index()
India

plt.figure(figsize=(20,5))
sns.pointplot(data=US,x='Date',y='Confirmed',color='Red')
sns.pointplot(data=China,x='Date',y='Confirmed',color='Blue')
sns.pointplot(data=India,x='Date',y='Confirmed',color='Yellow')

plt.ylabel('no of confirmed Cases')
plt.xlabel('Dates')
plt.show()

plt.figure(figsize=(20,5))
sns.pointplot(data=US,x='Date',y='Recovered',color='Red')
sns.pointplot(data=China,x='Date',y='Recovered',color='Blue')
sns.pointplot(data=India,x='Date',y='Recovered',color='Yellow')

plt.ylabel('no of Recovered Cases')
plt.xlabel('Dates')
plt.show()

plt.figure(figsize=(20,5))
sns.pointplot(data=US,x='Date',y='Active',color='Red')
sns.pointplot(data=China,x='Date',y='Active',color='Blue')
sns.pointplot(data=India,x='Date',y='Active',color='Yellow')

plt.ylabel('no of Active Cases')
plt.xlabel('Dates')
plt.show()

plt.figure(figsize=(20,5))
sns.pointplot(data=US,x='Date',y='Deaths',color='Red')
sns.pointplot(data=China,x='Date',y='Deaths',color='Blue')
sns.pointplot(data=India,x='Date',y='Deaths',color='Yellow')

plt.ylabel('no of Deaths Cases')
plt.xlabel('Dates')
plt.show()

"""**Model Bulding**"""

# Intalling prophet
!pip install prophet

# The columns names should me ds and y and its madatory
confirmed_cases=df.groupby(['Date']).sum()['Confirmed'].reset_index()

confirmed_cases.columns=['ds','y']
confirmed_cases

from prophet import Prophet

model=Prophet()

model.fit(confirmed_cases)

future=model.make_future_dataframe(periods=7)
forcasted=model.predict(future)
forcasted

forcasted[['yhat_lower','yhat','yhat_upper']]

model.plot(forcasted)
plt.show()

recovered_cases.columns=['ds','y']

# recovered_cases
model_recovered=Prophet()
model_recovered.fit(recovered_cases)
future=model_recovered.make_future_dataframe(periods=7)
forcasted=model_recovered.predict(future)
forcasted

active_cases.columns=['ds','y']

# recovered_cases
model_active=Prophet()
model_active.fit(active_cases)
future=model_active.make_future_dataframe(periods=7)
forcasted=model_active.predict(future)
forcasted

death_cases.columns=['ds','y']

# recovered_cases
model_death=Prophet()
model_death.fit(death_cases)
future=model_death.make_future_dataframe(periods=7)
forcasted=model_death.predict(future)
forcasted

import plotly

import plotly.express as px

world=df.groupby(['Country'])[['Confirmed','Active','Deaths','Recovered']].sum().reset_index()
world

figure=px.choropleth(world,locations='Country',locationmode='country names',color='Active',hover_name='Country',range_color=[1,100000],color_continuous_scale='reds',title='World map for the Active cases')
figure.show()

